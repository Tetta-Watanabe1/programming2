<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>プログラミングII演習課題の手引き 5_4_standard_deviation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href=".README.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">プログラミングII演習課題の手引き<br />
5_4_standard_deviation</h1>
</header>
<h1 data-number="1" id="説明"><span
class="header-section-number">1</span> 説明</h1>
<p>入力された数列の平均と標準偏差を出力せよ．数列はdouble型の配列に格納し，その配列のメモリは<code>malloc</code>関数で確保すること．</p>
<p>テストでは一千万要素(10,000,000)以上の数列を扱う．<code>malloc</code>関数の代わりに可変長配列を使うと百万要素（1,000,000）あたりで実行時にエラー（Segmentation
fault）になる．</p>
<p>
<strong>コマンドライン引数：</strong>数列の要素数<code>n</code>（<span
class="math inline">\({\tt n}&gt;1\)</span>）</p>
<p> <strong>入力：</strong> <code>n</code>個の実数．次のように<span
class="math inline">\(i\)</span>番目の実数を<span
class="math inline">\(a_i\)</span>で表す．</p>
<p><span class="math display">\[a_0,\; a_1,\; a_2,\; \ldots,\;
a_{n-1}\]</span></p>
<p> <strong>出力：</strong></p>
<ul>
<li><p>次式で求めた平均<span
class="math inline">\(\bar{a}\)</span>を1行目に出力し，標準偏差<span
class="math inline">\(\sigma\)</span>を2行目に出力する．分散<span
class="math inline">\(\sigma^2\)</span>を出力するのではないことに注意．</p>
<p><span class="math display">\[\begin{eqnarray*}
  平均：\ \bar{a} &amp;=&amp; \frac{1}{n}\sum_{i=0}^{n-1}a_i \\
  標準偏差：\ \sigma &amp;=&amp; \sqrt{\frac{1}{n}\sum_{i=0}^{n-1}(a_i -
\bar{a})^2} \\
\end{eqnarray*}\]</span></p></li>
<li><p>平均と標準偏差は小数第3位まで出力する（<code>"%.3f"</code>）．</p></li>
</ul>
<p>
<strong>コンパイル：</strong>（Cygwinの場合は<code>-lm</code>は不要．Ubuntu
Linuxでは<code>-lm</code>が必要）</p>
<pre><code>    $ gcc -Wall -o standard_deviation standard_deviation.c -lm</code></pre>
<h1 data-number="2" id="testlist"><span
class="header-section-number">2</span> テスト一覧</h1>
<p>テスト番号: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16</p>
<p>（1行が長い場合にブラウザでは複数行に分けて表示される場合あるので注意すること）</p>
<p><strong>テスト1</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 1</code></pre>
<p>入力</p>
<pre><code>1.0</code></pre>
<p>出力</p>
<pre><code>1.000
0.000</code></pre>
<p><strong>テスト2</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 2</code></pre>
<p>入力</p>
<pre><code>1.0 1.0</code></pre>
<p>出力</p>
<pre><code>1.000
0.000</code></pre>
<p><strong>テスト3</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 2</code></pre>
<p>入力</p>
<pre><code>0.0 10.0</code></pre>
<p>出力</p>
<pre><code>5.000
5.000</code></pre>
<p><strong>テスト4</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 2</code></pre>
<p>入力</p>
<pre><code>10.0 10.0</code></pre>
<p>出力</p>
<pre><code>10.000
0.000</code></pre>
<p><strong>テスト5</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 10</code></pre>
<p>入力</p>
<pre><code>1 2 3 4 5 6 7 8 9 10</code></pre>
<p>出力</p>
<pre><code>5.500
2.872</code></pre>
<p><strong>テスト6</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 20</code></pre>
<p>入力</p>
<pre><code>1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10</code></pre>
<p>出力</p>
<pre><code>5.500
2.872</code></pre>
<p><strong>テスト7</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 9</code></pre>
<p>入力</p>
<pre><code>-4 -3 -2 -1 0 1 2 3 4</code></pre>
<p>出力</p>
<pre><code>0.000
2.582</code></pre>
<p><strong>テスト8</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 9</code></pre>
<p>入力</p>
<pre><code>-40 -30 -20 -10 0 10 20 30 40.0</code></pre>
<p>出力</p>
<pre><code>0.000
25.820</code></pre>
<p><strong>テスト9</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 10</code></pre>
<p>入力</p>
<pre><code>96.0 63.0 36.0 51.0 98.0 21.0 18.0 64.0 77.0 44.0</code></pre>
<p>出力</p>
<pre><code>56.800
26.739</code></pre>
<p><strong>テスト10</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./standard_deviation 20</code></pre>
<p>入力</p>
<pre><code>89.0 68.0 77.0 84.0 51.0 85.0 16.0 96.0 13.0 93.0 18.0 38.0 76.0 47.0
26.0 26.0 34.0 30.0 26.0 97.0</code></pre>
<p>出力</p>
<pre><code>54.500
29.569</code></pre>
<p><strong>テスト11</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 100 &lt; tests/11.in</code></pre>
<p>入力</p>
<pre><code>93.0 17.0 40.0 88.0 78.0 28.0 1.0 62.0 77.0 4.0 73.0 18.0 99.0 32.0
83.0 48.0 10.0 62.0 94.0 10.0 10.0 58.0 10.0 62.0 60.0 9.0 71.0 39.0
45.0 53.0 58.0 99.0 69.0 23.0 6.0 30.0 95.0 50.0 7.0 49.0 70.0 65.0
46.0 71.0 98.0 70.0 38.0 66.0 38.0 93.0 46.0 27.0 66.0 56.0 89.0 44.0
5.0 65.0 32.0 17.0 28.0 87.0 13.0 68.0 64.0 39.0 4.0 48.0 20.0 50.0
5行目以降省略（8行）</code></pre>
<p>入力の全体は <code>cat tests/11.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>50.950
28.091</code></pre>
<p><strong>テスト12</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 1000 &lt; tests/12.in</code></pre>
<p>入力</p>
<pre><code>69.0 99.0 13.0 65.0 66.0 9.0 48.0 40.0 53.0 85.0 2.0 66.0 19.0 3.0
68.0 59.0 56.0 22.0 17.0 95.0 89.0 68.0 22.0 77.0 60.0 53.0 94.0 84.0
3.0 66.0 89.0 97.0 42.0 50.0 62.0 60.0 75.0 33.0 80.0 51.0 82.0 65.0
36.0 32.0 91.0 57.0 18.0 31.0 19.0 17.0 66.0 17.0 24.0 2.0 80.0 49.0
29.0 17.0 90.0 80.0 33.0 98.0 45.0 84.0 8.0 77.0 65.0 99.0 25.0 88.0
5行目以降省略（72行）</code></pre>
<p>入力の全体は <code>cat tests/12.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>48.993
28.914</code></pre>
<p><strong>テスト13</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 10000 &lt; tests/13.in</code></pre>
<p>入力</p>
<pre><code>11.0 97.0 78.0 0.0 6.0 52.0 38.0 82.0 65.0 2.0 68.0 25.0 48.0 20.0
14.0 83.0 23.0 16.0 83.0 12.0 30.0 26.0 53.0 51.0 64.0 46.0 59.0 56.0
56.0 20.0 85.0 88.0 87.0 78.0 14.0 73.0 10.0 63.0 63.0 14.0 66.0 61.0
61.0 23.0 33.0 33.0 41.0 76.0 91.0 15.0 38.0 95.0 43.0 73.0 8.0 84.0
28.0 40.0 75.0 14.0 67.0 5.0 46.0 83.0 9.0 8.0 58.0 9.0 16.0 67.0 3.0
5行目以降省略（712行）</code></pre>
<p>入力の全体は <code>cat tests/13.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>49.908
28.981</code></pre>
<p><strong>テスト14</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 100000 &lt; tests/14.in</code></pre>
<p>入力</p>
<pre><code>4.0 8.0 5.0 6.0 6.0 1.0 2.0 9.0 9.0 0.0 4.0 3.0 4.0 9.0 5.0 9.0 9.0
2.0 5.0 7.0 0.0 7.0 4.0 4.0 0.0 5.0 7.0 9.0 6.0 5.0 7.0 4.0 3.0 5.0
7.0 3.0 5.0 2.0 5.0 9.0 4.0 5.0 9.0 9.0 8.0 6.0 6.0 6.0 5.0 1.0 1.0
2.0 0.0 6.0 7.0 3.0 5.0 2.0 6.0 7.0 4.0 6.0 7.0 5.0 9.0 3.0 6.0 2.0
4.0 1.0 3.0 7.0 6.0 6.0 0.0 5.0 3.0 5.0 5.0 8.0 2.0 5.0 8.0 3.0 2.0
5行目以降省略（5883行）</code></pre>
<p>入力の全体は <code>cat tests/14.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>4.521
2.867</code></pre>
<p><strong>テスト15</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 1000000 &lt; tests/15.in</code></pre>
<p>入力</p>
<pre><code>8.0 55.0 71.0 64.0 47.0 4.0 20.0 68.0 58.0 26.0 77.0 13.0 12.0 4.0
98.0 12.0 73.0 25.0 8.0 44.0 24.0 58.0 30.0 95.0 33.0 29.0 57.0 67.0
14.0 74.0 26.0 42.0 69.0 67.0 70.0 14.0 62.0 91.0 89.0 44.0 23.0 63.0
66.0 79.0 72.0 27.0 98.0 48.0 52.0 17.0 29.0 4.0 39.0 15.0 23.0 90.0
55.0 15.0 58.0 44.0 38.0 91.0 21.0 84.0 35.0 96.0 28.0 29.0 47.0 67.0
5行目以降省略（71153行）</code></pre>
<p>入力の全体は <code>cat tests/15.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>49.480
28.866</code></pre>
<p><strong>テスト16</strong></p>
<p>コマンドライン（入力量が多いためファイルから与える）</p>
<pre><code>$ ./standard_deviation 10000000 &lt; tests/16.in</code></pre>
<p>入力</p>
<pre><code>82.0 1.0 39.0 100.0 73.0 12.0 8.0 33.0 81.0 64.0 20.0 15.0 79.0 81.0
16.0 38.0 82.0 8.0 66.0 33.0 28.0 22.0 22.0 4.0 95.0 78.0 93.0 49.0
13.0 80.0 34.0 27.0 0.0 46.0 9.0 5.0 82.0 36.0 42.0 36.0 31.0 58.0
30.0 73.0 98.0 27.0 31.0 49.0 0.0 3.0 12.0 89.0 89.0 23.0 22.0 20.0
30.0 7.0 46.0 33.0 19.0 51.0 85.0 89.0 80.0 59.0 5.0 27.0 30.0 74.0
5行目以降省略（711967行）</code></pre>
<p>入力の全体は <code>cat tests/16.in</code>
コマンドを実行すると表示される．</p>
<p>出力</p>
<pre><code>49.998
29.158</code></pre>
<h1 data-number="3" id="配布ファイル"><span
class="header-section-number">3</span> 配布ファイル</h1>
<p>ファイル名: standard_deviation.c</p>
<pre><code>/**

氏名: 

学生番号: 

作成日: 

入出力の説明: 

動きの説明: 

感想: 

*/</code></pre>
<h1 data-number="4" id="ヒント"><span
class="header-section-number">4</span> ヒント</h1>
<ul>
<li><p>Cの絵本
メモリ確保とポインタの活用(1)．明快入門Cには<code>malloc</code>関数の記載なし．</p></li>
<li><p><code>malloc</code>関数は<code>stdlib.h</code>ヘッダファイルで宣言されているので，
<code>&lt;stdlib.h&gt;</code>をインクルード（<code>include</code>）する<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a>．</p></li>
<li><p>大きな配列（<code>double a[1000000];</code>など）を宣言すると実行時にエラー（segmentation
faultなど）になることがあるが，同じ大きさの配列を
<code>malloc</code>関数で確保しても失敗しないことが多い．詳しくは説明しないが，前者がメモリのスタック領域を，後者がヒープ領域を使うことに起因する．</p></li>
<li><p>「君はマロックなんていらない」を歌って覚えよう．あいみょん「君はロックを聴かない」のメロディーで（改変を募集中）
<a href="https://youtu.be/cJnO-Y_YnFg?t=59"
class="uri">https://youtu.be/cJnO-Y_YnFg?t=59</a></p>
<pre><code>stdlib（スタンダードリブ）にある機能
メモリをいるだけアロケート
君はマロック（malloc）なんかいらないと
いうけれど
少しでも僕に近づいてほしくて
マロックなんか使わないと思うけれども
僕はこんなマロック（malloc）であんなフリー（free）で
エラーを乗り越えてきた</code></pre>
<p>（2022年度伊藤 光希さん改変）</p></li>
<li><p>数値を格納する配列は<code>float</code>型ではなく，<code>double</code>型を使うこと．要素数
<code>n</code>が大きくなったときに，誤差が大きくなるため．<code>double</code>型変数（や
<code>double</code>型の配列要素）を引数にとる<code>scanf</code>関数では書式指定子は
<code>"%lf"</code>を使う．<code>printf</code>関数の書式指定子は<code>float</code>型と同じ<code>"%f"</code>を使う．</p></li>
<li><p>コマンドライン引数は文字列で与えられる．<code>atoi</code>関数を使うことで整数に変換する．<code>atoi</code>関数は<code>stdlib.h</code>ヘッダファイルで次のように宣言されている．</p>
<pre><code>int atoi(char *str);</code></pre></li>
<li><p>次のように<code>malloc</code>関数を使って，<code>n</code>要素の<code>double</code>型の配列として使うメモリ領域を確保する．この後，<code>double a[1000];</code>のように配列を宣言したときと同じように<code>a</code>を配列として使える．配列のサイズが入力によって変わる場合や，配列サイズが大きい場合には配列宣言の代わりに<code>malloc</code>関数を使う方がよい．使い終わったら<code>free</code>関数で確保したメモリを開放する．</p>
<pre><code>int n;
double *a;

n = 1000;
a = (double *) malloc(sizeof(double) * n);
if (a == NULL) { // メモリが確保できなければ
  fprintf(stderr, &quot;Cannot allocate memory\n&quot;);
  return 1;
}
// 配列要素 a[0] から a[999] を使う
// （double a[1000];と宣言した場合と同じように1000要素ある）
free(a);</code></pre>
<p><code>malloc</code>関数の次の行の<code>if</code>文はメモリ領域を確保できなかったときの処理である．<code>malloc</code>関数はメモリ確保に失敗すると<code>NULL</code>（ヌルポインタ）を返す．<code>malloc</code>関数で確保するメモリの大きさが大きい場合などに，確保できないことがある．<code>fprintf</code>文は標準エラー出力(<code>stderr</code>)にメッセージを出力する．<code>return</code>文で関数を終了する．なお，<code>free</code>関数で解放されないメモリ領域はこのプログラム<code>standard_deviation</code>が終了するまで確保されたままになる．（この課題ではメモリ領域が確保できない場合のテストは行わない．標準エラー出力についてはこの科目で覚える必要はない）</p></li>
<li><p>分散<span
class="math inline">\(\sigma^2\)</span>から標準偏差<span
class="math inline">\(\sigma\)</span>を求めるときに平方根を求める
<code>sqrt</code>関数を使う．<code>sqrt</code>関数は<code>math.h</code>ヘッダファイルで次のように宣言されている．</p>
<pre><code>double sqrt(double x);</code></pre></li>
<li><p>行数の多いテストを手動で試す方法：テストに次のようなメッセージで失敗するとする．</p>
<pre><code>$ ./standard_deviation 100000
（中略）
6行目以降は省略（tests/8.in）
（中略）</code></pre>
<p>これと同じ入力でテストしたいときは，ターミナルで次のようにコマンドを入力する．</p>
<pre><code>$ ./standard_deviation 100000 &lt; tests/8.in</code></pre>
<p>なお，<code>&lt;</code>はその後にファイル名を書く．そのファイルをプログラムの標準入力に渡す記号．</p></li>
<li><p>（標準エラー出力について知りたい人向けの余談）</p>
<p>ターミナルでプログラムを実行したときに，<code>printf</code>関数で出力すると標準出力（<code>stdout</code>）に出力される．プログラムの出力先は，標準出力と標準エラー出力（<code>stderr</code>）の二つあり，どちらの出力もターミナルに出力される．標準エラー出力はプログラムが異常終了する場合などに，エラーメッセージを出力するために用いられるのが一般的である．例えば次のような2行だけからなる<code>main</code>関数を作成してみよう．</p>
<pre><code>printf(&quot;Hello, world!\n&quot;);
fprintf(stderr, &quot;Hello, standard error!\n&quot;);</code></pre>
<p>このプログラムを次のように実行すると，ターミナルには<code>printf</code>関数と
<code>fprintf</code>関数で指定した2行のメッセージが表示される．</p>
<pre><code>$ ./a.out
Hello, world!
Hello, standard error!</code></pre>
<p>ここで，標準出力と標準エラー出力を区別する方法を紹介する．標準出力を
<code>a.txt</code>ファイルに保存し，標準エラー出力は画面に表示するなら次のように実行する．実行ファイルの後に「<code>&gt; ファイル名</code>」と書くことで，標準出力はファイルに保存される．なお，コマンドライン引数がある場合は「<code>&gt; ファイル名</code>」は引数の後に書く．</p>
<pre><code>$ ./a.out &gt; a.txt
Hello, standard error!
$ cat a.txt
Hello, world!</code></pre>
<p>あるいは，標準出力を<code>a.txt</code>ファイルに保存し，標準エラー出力を別のファイル（<code>error.txt</code>）に保存するなら，次のように実行する．「<code>2&gt; error.txt</code>」の「2」は標準エラー出力が2番目の出力という意味であり，<code>error.txt</code>の部分がファイル名である．</p>
<pre><code>$ ./a.out &gt; a.txt 2&gt; error.txt
$ cat a.txt
Hello, world!
$ cat error.txt
Hello, standard error!</code></pre></li>
<li><p>WSL Ubuntu Linux
の<code>gcc</code>などでは<code>sqrt</code>関数を使う際に<code>-lm</code>オプションが必要です．コンパイル時に次のエラーが出たら，<code>gcc</code>コマンドを実行する際に
<strong>コマンドラインの最後</strong>
に<code>-lm</code>オプションをつけましょう．
<code>ld</code>が<code>sqrt</code>を見つけられないというエラーです．<code>ld</code>は<code>gcc</code>を実行したときにこっそり(?)実行されているリンカーと呼ぶプログラムです．</p>
<pre><code>/usr/bin/ld: ....o: in function `main&#39;:
standard_deviation_correct.c:(.text+0x...): undefined reference to `sqrt&#39;
collect2: error: ld returned 1 exit status</code></pre></li>
</ul>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li
id="fn1"><p>Cの絵本「メモリの確保とポインタの活用(1)」には<code>#include &lt;memory.h&gt;</code>と<code>#include &lt;malloc.h&gt;</code>
と<code>#include &lt;stdlib.h&gt;</code>の三つのヘッダファイルが必要と書かれているが，Cygwinでは<code>#include &lt;stdlib.h&gt;</code>のみで十分．<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
