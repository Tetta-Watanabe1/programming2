<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>プログラミングII演習課題の手引き 5_6_find_options</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href=".README.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">プログラミングII演習課題の手引き<br />
5_6_find_options</h1>
</header>
<h1 data-number="1" id="説明"><span
class="header-section-number">1</span> 説明</h1>
<p><strong>発展課題</strong>（未提出でも減点しない）</p>
<p>コマンドライン引数に応じて，<code>main</code>関数から適切な関数を呼べ．複数の引数がある場合は先頭から順に複数の関数を呼ぶこと．</p>
<p> <strong>コマンドライン引数：</strong></p>
<ul>
<li><p>オプションが与えられる．</p></li>
<li><p>オプションは<code>-</code>（マイナス）から始まる文字列で，次の5種類がある．</p>
<pre><code>--help, --version, --search, --save, --test</code></pre>
<p>これらの省略形として，次の文字列もオプションである．</p>
<pre><code>-h, -v, -s, -S, -t</code></pre></li>
<li><p>オプションが2個以上与えられることがある．</p></li>
</ul>
<p> <strong>入力：</strong>なし．</p>
<p> <strong>出力：</strong></p>
<ul>
<li><p>オプションと同名の5つ関数がすでに用意してある．これらの関数を呼び出すことで，適切な出力が得られる．（以下の出力例を見よ）</p></li>
<li><p>複数のオプションがコマンドライン引数に与えられた場合は，先頭から順にすべてのオプションを処理する．<code>make test</code>では検査していないので，各自確認すること．</p></li>
<li><p>ここで説明してないオプションは無視してよい．</p></li>
</ul>
<p>
<strong>オプションの説明：</strong>（分かりにくいところはヒントを見よ）</p>
<ul>
<li><p>2つのオプション<code>--help</code>，<code>--version</code>は，それぞれ<code>help</code>関数と
<code>version</code>関数を呼び出すことで，コマンドの使い方またはバージョンを表示する．実行例を示す．実行例の出力は省略．<code>--help</code>の省略形を<code>-h</code>，
<code>--version</code>の省略形を<code>-v</code>とする．</p>
<pre><code>$ ./find_options --help
$ ./find_options -h
$ ./find_options --version
$ ./find_options -v</code></pre></li>
<li><p>2つのオプション<code>--search</code>，<code>--save</code>はそれぞれ<code>search</code>関数か<code>save</code>関数を呼び出すことで，1行のメッセージを出力する．<code>--search</code>の後には検索キーワードが続き，<code>--save</code>の後にはファイル名の文字列が続くとする．また，前者の省略形を<code>-s</code>，後者の省略形を<code>-S</code>とする．この検索キーワードあるいはファイル名は，<code>search</code>関数と<code>save</code>関数に引数として渡す．
<code>keyword</code>を検索キーワードにした実行例を示す．</p>
<pre><code>$ ./find_options --search keyword
$ ./find_options -s keyword
$ ./find_options --save filename
$ ./find_options -S filename</code></pre></li>
<li><p>オプション<code>--test</code>（省略形は<code>-t</code>）
は，直後にテスト番号とテスト文字列が続く．<code>test</code>関数にこれら二つの引数を渡す．テスト番号は1から9の数字，テスト文字列は（空白を含まない）文字列とする．テスト番号1とテスト文字列<code>"test_string"</code>の実行例を示す．</p>
<pre><code>$ ./find_options --test 1 test_string
$ ./find_options --test 9 test9
$ ./find_options -t 1 test_string</code></pre></li>
</ul>
<p> <strong>コンパイル：</strong></p>
<pre><code>    $ gcc -Wall -o find_options find_options.c</code></pre>
<h1 data-number="2" id="testlist"><span
class="header-section-number">2</span> テスト一覧</h1>
<p>テスト番号: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,
17, 18</p>
<p>（1行が長い場合にブラウザでは複数行に分けて表示される場合あるので注意すること）</p>
<p><strong>テスト1</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --help</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Usage: find_options [options]
Options:
--help, -h                  Display this information
--version, -v               Display version information
--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string
--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;
--test, -t                  Test this command</code></pre>
<p><strong>テスト2</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --version</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>find_options 1.3</code></pre>
<p><strong>テスト3</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --search hoge</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Search hoge (not implemented)</code></pre>
<p><strong>テスト4</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --save out.txt</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Save into out.txt (not implemented)</code></pre>
<p><strong>テスト5</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --test 1 test_string</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Test case 1 with &quot;test_string&quot; (not implemented)</code></pre>
<p><strong>テスト6</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -h</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Usage: find_options [options]
Options:
--help, -h                  Display this information
--version, -v               Display version information
--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string
--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;
--test, -t                  Test this command</code></pre>
<p><strong>テスト7</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -v</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>find_options 1.3</code></pre>
<p><strong>テスト8</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -s hoge</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Search hoge (not implemented)</code></pre>
<p><strong>テスト9</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -S out.txt</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Save into out.txt (not implemented)</code></pre>
<p><strong>テスト10</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -t 1 test_string</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Test case 1 with &quot;test_string&quot; (not implemented)</code></pre>
<p><strong>テスト11</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -t 5 another_test_string</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Test case 5 (&quot;another_test_string&quot; is ignored) (not implemented)</code></pre>
<p><strong>テスト12</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -v -h</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>find_options 1.3
Usage: find_options [options]
Options:
--help, -h                  Display this information
--version, -v               Display version information
--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string
--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;
--test, -t                  Test this command</code></pre>
<p><strong>テスト13</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -v -h -s hoge -t 1 test_string</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>find_options 1.3
Usage: find_options [options]
Options:
--help, -h                  Display this information
--version, -v               Display version information
--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string
--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;
--test, -t                  Test this command
Search hoge (not implemented)
Test case 1 with &quot;test_string&quot; (not implemented)</code></pre>
<p><strong>テスト14</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options </code></pre>
<p>入力なし</p>
<p>出力</p>
<p><strong>テスト15</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --search --help</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Search --help (not implemented)</code></pre>
<p><strong>テスト16</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options --save --version</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Save into --version (not implemented)</code></pre>
<p><strong>テスト17</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -t 2 --version</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Test case 2 with &quot;--version&quot; (not implemented)</code></pre>
<p><strong>テスト18</strong></p>
<p>コマンドライン</p>
<pre><code>$ ./find_options -t 2 --version --help</code></pre>
<p>入力なし</p>
<p>出力</p>
<pre><code>Test case 2 with &quot;--version&quot; (not implemented)
Usage: find_options [options]
Options:
--help, -h                  Display this information
--version, -v               Display version information
--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string
--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;
--test, -t                  Test this command</code></pre>
<h1 data-number="3" id="配布ファイル"><span
class="header-section-number">3</span> 配布ファイル</h1>
<p>ファイル名: find_options.c</p>
<pre><code>/**

氏名: 

学生番号: 

作成日: 

入出力の説明: 

動きの説明: 

感想: 

*/
#include &lt;stdio.h&gt;

/** 使い方を出力する */
void help() {
  printf(&quot;Usage: find_options [options]\n&quot;
         &quot;Options:\n&quot;
         &quot;--help, -h                  Display this information\n&quot;
         &quot;--version, -v               Display version information\n&quot;
         &quot;--search &lt;arg&gt;, -s &lt;arg&gt;    Search &lt;arg&gt; string\n&quot;
         &quot;--save &lt;file&gt;, -S &lt;file&gt;    Save into &lt;file&gt;\n&quot;
         &quot;--test, -t                  Test this command\n&quot;);
}

/** バージョン番号を出力する */
void version() {
  printf(&quot;find_options 1.3\n&quot;);
}

/** 文字列を検索する（未実装） */
int search(char term[]) {
  printf(&quot;Search %s (not implemented)\n&quot;, term);
  return 0;
}

/** ファイルに保存する（未実装） */
int save(char filename[]) {
  printf(&quot;Save into %s (not implemented)\n&quot;, filename);
  return 0;
}

/** このコマンドをテストする（未実装） */
int test(int i, char str[]) {
  if (0 &lt; i &amp;&amp; i &lt; 5) {
    printf(&quot;Test case %d with \&quot;%s\&quot; (not implemented)\n&quot;, i, str);
  } else if (5 &lt;= i &amp;&amp; i &lt; 10) {
    printf(&quot;Test case %d (\&quot;%s\&quot; is ignored) (not implemented)\n&quot;, i, str);
  }
  return 0;
}

// ここにmain関数を定義する．</code></pre>
<h1 data-number="4" id="ヒント"><span
class="header-section-number">4</span> ヒント</h1>
<ul>
<li><p><code>main</code>関数は，コマンドライン引数を第1引数<code>argc</code>と第2引数<code>argv</code>として受け取る．例えば，ターミナルで</p>
<pre><code>$ ./find_options -v --search keyword</code></pre>
<p>を実行すると，次のように仮引数が初期化されて<code>main</code>関数に渡される．</p>
<pre><code>argc = 4;
argv[] = {&quot;./find_options&quot;, &quot;-v&quot;,
          &quot;--search&quot;, &quot;keyword&quot;, NULL};</code></pre></li>
<li><p><code>argv[0]</code>は<code>"./find_options"</code>であることに注意しよう．オプションの文字列は<code>argv[1]</code>以降．</p></li>
<li><p>二つの文字列の比較には<code>strcmp</code>関数が使える．<code>strcmp</code>関数の説明は明快入門C
238ページやCygwinオンラインマニュアルなどにある．<code>strcmp</code>関数は，引数の二つの文字列が一致するときに<code>0</code>を返す．<code>strcmp</code>関数を使うには<code>#include &lt;string.h&gt;</code>が必要である．以下にCygwinオンラインマニュアルの先頭部分を引用する．「<code>strcmp</code>というマニュアルはありません」と表示される場合は
Bb9 の「必携 PC(Windows 10)の演習準備」ページの「Cygwin の man
コマンドの使い方」という項目をみよ.</p>
<pre><code>$ man strcmp
STRCMP(3)   Strings and Memory (string.h)

NAME
       strcmp - character string compare

SYNOPSIS
       #include &lt;string.h&gt;

       int strcmp(const char *a, 
                  const char *b);

DESCRIPTION
       strcmp compares the string at a to
       the string at b.
RETURNS</code></pre></li>
<li><p><code>argv[1]</code>は，例えば文字列<code>"-v"</code>へのポインタである．文字列
<code>"--version"</code>と一致するか調べるには次のように<code>if</code>文と<code>strcmp</code>関数を組み合わせて使う．</p>
<pre><code>if (strcmp(argv[1], &quot;--version&quot;) == 0)</code></pre></li>
<li><p>検索キーワードなどの文字列が続く<code>--search</code>や<code>--save</code>の場合，文字列はポインタ<code>argv[2]</code>が指している．<code>search</code>関数や<code>save</code>関数の実引数には
<code>argv[2]</code>を与える．</p></li>
<li><p><code>test</code>関数の第1引数は<code>int</code>型である．次のように端末で実行すると
<code>argv[2]</code>は文字列<code>"3"</code>である．</p>
<pre><code>$ ./find_options -t 3 test_string</code></pre>
<p>この文字列を<code>int</code>型の数値に変換するには，<code>atoi</code>関数を使う．<code>atoi</code>関数は<code>stdlib</code>ヘッダファイルで宣言されている．あるいは，<code>atoi</code>関数を使う代わりに，この数値の範囲が1から9の1文字であることを利用して
<code>argv[2][0] - '0'</code>で数値に変換することもできる．</p>
<pre><code>int i;
i = atoi(argv[2]);
i = argv[2][0] - &#39;0&#39;;</code></pre></li>
<li><p>（復習）
<code>argv[1]</code>が<code>"--help"</code>か<code>"-h"</code>のどちらかに一致したらという条件式は論理和（<code>||</code>）演算子を使う．</p>
<pre><code>if (strcmp(argv[1], &quot;--help&quot;) == 0 ||
    strcmp(argv[1], &quot;-h&quot;) == 0)</code></pre></li>
<li><p>よくわからなくなったときは，次のような<code>main</code>関数を実行してみるとよい．</p>
<pre><code>int main(int argc, char *argv[]) {
  int i;
  printf(&quot;%d\n&quot;, argc);
  for (i = 0; i &lt;= argc; i++)
     printf(&quot;%d %p %s\n&quot;,
            i, argv[i], argv[i]);
}</code></pre></li>
</ul>
</body>
</html>
